# JOUR 18

## LIVESHARE

https://prod.liveshare.vsengsaas.visualstudio.com/join?3006D592432BD96F91CC25E26BF1DF027089

## NEWS / QUESTIONS

## PLANNING DU JOUR

    * SQL: RELATIONS ET JOINTURES
    * PHP: CRUD

## EVALUATION

    CREER UN NOUVEAU DOSSIER multicrud

### EXERCICE 1: CREER LA DATABASE ET LES TABLES

    TABLES SQL: 2 AU MINIMUM
    UN CRUD PAR TABLE SQL

    DATABASE multicrud
        AVEC LE CHARSET utf8mb4_general_ci

    TABLE1  user
        id              INT             PRIMARY_KEY     A_I
        login           VARCHAR(160)
        password        VARCHAR(160)
        ...

    TABLE2  contenu
        id              INT             PRIMARY_KEY     A_I
        titre           VARCHAR(160)
        description     TEXT
        photo           VARCHAR(160)
        id_user         INT             => (POUR NOUS...) CLE ETRANGERE VERS CLE PRIMAIRE id DE LA TABLE user
        ...

    (PAS BESOIN DE RAJOUTER DE CONTRAINTE DE CLE ETRANGERE AU DEPART => SECURITE SUPPLEMENTAIRE...) 

    RELATION ENTRE LES 2 TABLES 
    POUR UNE LIGNE DE user COMBIEN DE LIGNES DE contenu ?
    => MANY
    => UN UTILISATEUR PEUT CREER PLUSIEURS CONTENUS

    POUR UNE LIGNE DE contenu COMBIEN DE LIGNES DE user ?
    => ONE
    => UN CONTENU N'A QU'UN SEUL AUTEUR

    RELATION ONE-TO-MANY DE user VERS contenu
    => TECHNIQUE: AJOUTER UNE COLONNE DE CLE ETRANGERE DANS LA TABLE MANY contenu

### EXERCICE 2: CREATE SUR LES 2 TABLES

    CREER 2 PAGES AVEC UN FORMULAIRE DE CREATE POUR CHAQUE TABLE

    => SUR LE CREATE: QUAND ON AJOUTE UNE NOUVELLE LIGNE DANS contenu
            IL FAUDRA EN PLUS FOURNIR LA VALEUR POUR LA CLE ETRANGERE id_user
            => IL FAUT CONNAITRE L'AUTEUR AVANT DE CREER LE CONTENU
                (POUR L'EXERCICE, ON AURA UN CHAMP POUR SAISIR id_user...)

            SUR UN VRAI PROJET:
            => CA SE PASSE BIEN DANS LE SCENARIO HABITUEL
                LE MEMBRE S'IDENTIFIE => ON CONNAIT SON id 
                ET ENSUITE IL PEUT CREER UN CONTENU

### EXERCICE 3: READ AVEC JOINTURES

    (SI ON A BLOQUE SUR L'EXERCICE 2... AVEC PHPMYADMIN... AJOUTER DES LIGNES DANS LES 2 TABLES SQL...)

    REQUETE AVEC JOINTURE:
    SI JE VEUX AFFICHER LA LISTE DES CONTENUS ET LE login DE L'AUTEUR DE CHAQUE CONTENU

    SELECT *
    FROM contenu
    INNER JOIN user
        ON user.id = contenu.id_user


    * SUR LA PAGE DU MEMBRE 'toto'
    JE VEUX AFFICHER LA LISTE DE SES CONTENUS POUR LE user QUI A login = 'toto' 

    SELECT *
    FROM contenu
    INNER JOIN user
        ON user.id = contenu.id_user
    WHERE user.login = 'toto'


## AJOUTER UNE CONTRAINTE DE CLE ETRANGERE

    DANS LA TABLE article AJOUTER UNE COLONNE id_user AVEC PhpMyAdmin
    REMPLIR LA COLONNE AVEC UN id EXISTANT DANS user (FAIRE UNE REQUETE SQL UPDATE...)
    ET ENSUITE LANCER LA COMMANDE SQL POUR AJOUTER LA CONTRAINTE DE CLE ETRANGERE

    ALTER TABLE `article`
    ADD KEY `id_user` (`id_user`),
    ADD CONSTRAINT `article_ibfk_1` FOREIGN KEY (`id_user`) REFERENCES `user` (`id`);



    PAUSE JUSQU'A 11H05